---
title: 基礎因果模型
date: "2022-02-09"
category: Causality
tags:
 - philosophy
 - causal model
---

## 基本說明

### 基本語言

在不特別說明的情況下，我們的語言使用規定如下：

* 集合論語言：我們會直接使用某套集合論標準語言，包括 $\empty, \in, -, \subset, =, \forall, \exists$ 等。
* **變數**：$X, X_1, X_2, ...$，我們以變數來為世界狀態建立模型。也可以用 $Y, Z$ 等。
* **值**：$x, x_1, x_2, ...$，之於變數的值。也可以用 $y,z$ 等，沒有特別說明的話，值用變數的小寫表示。
* **模型**：所有變數的集合。
* 範圍：變數的所有可能值的集合。
* 命題：若 $x$ 屬於 $X$ 的範圍，$X = x$ 是一個原子命題，用 $p,q,r$ 表示。原子命題可透過邏輯連接詞 $\neg, \wedge, \vee, \rightarrow, \equiv$ 遞迴地連接成複雜命題。這是全部的布林命題。可以使用 $\bot,\top$，分別表示矛盾句與恆真句。
* **事件**：在機率論中，把命題稱作事件，以 $A,B,C$ 等表示。
* **世界**：對模型中所有變數的值進行一次完整分配的結果。
* 向量的表示：用粗體表示向量。變數的向量或說有序集合，表示成 $\mathbf{X}, \mathbf{Y}, ...$。值的向量表示成 $\mathbf{x},\mathbf{y},...$。
* 集合的表示：用希臘字母表示值的集合。
* 命題聯集的縮寫：若 $\phi$ 是包含於變數 $X$ 的範圍的值的集合，$X\in\phi$ 的意思是，$\exists x\in\phi(X=x)$。
* （準）世界的縮寫：$\mathbf{X} = \mathbf{x}$ 代表，若 $\mathbf{X}=\{X_1, ...,X_n\}$ 且 $\mathbf{x} = \{x_1,...,x_n\}$，則 $\forall i \in \{1,...,n\}(X_i=x_i)$。

### 貝式機率論

機率論語言：

* $P$：**機率函數**，定義域是事件，值域是 $[0,1]$，表示事件發生的機率。
* $P(A,B)$：**聯合機率**，即 $P(A \wedge B)$。形式定義為 $P(A)=P(A,B)+P(A,\neg B)$。更多事件的聯合機率可以寫成多元參數的形式，如 $P(A_1,A_2,...,A_n)$。

機率公設：

1. $0\leq P(A) \leq 1$。
2. $P(\top) =1$。
3. 若 $A\wedge B = \empty$，則 $P(A\vee B) = P(A)+P(B)$。

條件機率：

* $P(A|B) = \frac{P(A,B)}{P(B)}$。

### 有向無環圖（DAG, directed acyclic graph）

有向無環圖：

* **有向圖**：由頂點 $\mathbf{V}$ 和邊 $E$ （頂點到頂點的關係）構成的結構，表示成 $G=(\mathbf{V}, E)$。
* **路徑**：如果存在一個邊序列 $p = \lang e_1, e_2,..., e_n\rang$ 使得 $e_1 = (\mathbf{a} = \mathbf{v}_0,\mathbf{v}_1), e_2 = (\mathbf{v}_1,\mathbf{v}_2),\ ...\ , e_n = (\mathbf{v}_{n-1},\mathbf{v}_n = \mathbf{b})$，則 $p$ 是從 $\mathbf{a}$ 到 $\mathbf{b}$ 的（有向）路徑。
* **有向無環圖**：如果一個有向圖不存在無限長的路徑，我們稱之為有向無環圖。
* 我們也可以用箭頭連接頂點來表示單向關係。如果有必要，我們可以引入雙箭頭，這時候的圖形稱之為有向無環混合圖（ADMG, acyclic directed mixed graph）。
* 圖的父頂點：$PA_j = \{ X | \exists e\in E\ e(X, X_j) \}$ 代表 $X_j$ 的父頂點。

有向無環圖可以由**貝式網絡**（Bayesian networks）（Pearl, 1985）來構成：

* **貝式條件**：若 $\mathbf{V} =\{X_1,..., X_n\}$，則 $P(x_1,...,x_n) =\prod{P(x_j|x_1,...,x_{j-1})} \coloneqq \prod{P(x_j|pa_j)}$。
* **馬可夫父節點**：若 $MPA_j$ 是滿足 $P(x_j|mpa_j)=P(x_j|x_1,...,x_{j-1})$ （即「$X_j$ 對 $MPA_j$ 以外的所有的其他前節點獨立」）的最小集合，則 $MPA_j$ 是 $X_j$ 的馬可夫父節點。
* **馬可夫相容性**：對一個變數集合，將變數表示為頂點。如果機率函數 $P$ 和 $G$ 使每個頂點的在 $G$ 上的父頂點與馬可夫父節點相同，那麼我們說 $G$ 和 $P$ 是相容的，或 $G$ 表示了 $P$，或 $P$ 對 $G$ 是馬可夫相關的。

表示成有向無環圖，讓獨立的機率關係可以看得更清楚：

* d-分隔判準：如果路徑 $p$ 被頂點集合 $Z$ 所阻擋（d-分隔），若且唯若，

  1. 存在 $m$ 屬於 $Z$ 使得，$p$ 包含鏈 $i\rightarrow m\rightarrow j$，或分叉 $i\leftarrow m \rightarrow j$。
  2. $p$ 的所有反分叉（或對撞） $i\rightarrow m \leftarrow j$ 中的 $m$ 和 $m$ 的後代節點都不在 $Z$ 裡面。
* 如果節點 $X$ 到節點 $Y$ 的所有路徑都被 $Z$ 集合阻擋，那麼 $Z$ d-分隔了 $X$ 到 $Y$。

